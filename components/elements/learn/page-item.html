<dom-module id="page-item">
	<style>
		::content #page-container {
			position:relative;
			z-index:20;
		};

		::content #page-cover {
			width:100%;
			height:100%;

			display:block;
			height:0;
			position:absolute;
			margin-left:0%;
			overflow:hidden;
			opacity:0;
			top:0;
			right:0;
			z-index:1;
			cursor:pointer;
			-webkit-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
								width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
								right 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
								opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			   -moz-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			   					width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			   					right 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			   					opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			     -o-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			     				width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			     				right 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			     				opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			        transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			        			width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			        			right 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			        			opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);


			-webkit-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			   -moz-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			     -o-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			        transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
		};
		::content #page-cover-background {
			/*background-color:#338D83;*/
			background-color:#273238;
			opacity:0.6;
			width:100%;
			height:100%;
			position:absolute;
			top:0;
			left:0;
		};

		::content #page-cover-header {
			position:absolute;
			top:0;
			right:0;
			height:100vh;
			width:100%;
			display:flex;
			display: -webkit-flex;
			align-items: center;
			-webkit-align-items: center;
			-moz-align-items: center;
			-ms-align-items: center;
			justify-content: center;
			-webkit-justify-content: center;
			-moz-justify-content: center;
			-ms-justify-content: center;
		}
		::content #page-cover-header-container {
			text-align:center;
			padding-left:10px;
			padding-right:10px;
			z-index:1;
		};

		::content #page-cover-header-container paper-fab {
			/*background-color:#273238;
			color:#FFF;*/
			background-color:#80CBC4;
			color:#273238;

		};

		::content #page-cover-header h2 {
			display: block;
			text-align:center;
			font-family: Roboto, sans-serif;
			color: #FFF;
			font-size: 18px;
			font-weight: bold;
			text-shadow: 1px 1px 4px #273238;
			/*position: absolute;*/
			/*width:100%;*/
			/*right:0;
			top:50px;*/
			/*float:left;*/
			margin:0;
			/*transform-origin: left bottom 0;*/
/*			  -webkit-transform-origin: 50% 50%;
  -moz-transform-origin: 50% 50%;
  -ms-transform-origin: 50% 50%;
  -o-transform-origin: 50% 50%;
  transform-origin: 50% 50%;*/
/*			-webkit-transform: rotate(90deg);
				-ms-transform: rotate(90deg);
					transform: rotate(90deg);*/
		}

		::content #page-item {
			width:100%;
			height:100vh;
			position:absolute;
			background-color:#F4F4F4;
			top:0;
			margin-left:100%;

			/*overflow:hidden;*/
			overflow-y: scroll;
			-webkit-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
								width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
								box-shadow 250ms ease-in-out,
								opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			   -moz-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			   					width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			   					box-shadow 250ms ease-in-out,
			   					opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			     -o-transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			     				width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			     				box-shadow 250ms ease-in-out,
			     				opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);
			        transition: margin-left 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			        			width 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000),
			        			box-shadow 250ms ease-in-out,
			        			opacity 750ms cubic-bezier(0.770, 0.000, 0.175, 1.000);



			-webkit-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			   -moz-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			     -o-transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
			        transition-timing-function: cubic-bezier(0.770, 0.000, 0.175, 1.000);
		};

		::content #page-item.loaded {
			width:75%;
			margin-left:25%;

		};

		.material-shadow {
		  /*transition:box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);*/
		};

		.material-shadow[elevation="1"] {
		  box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14),
		                  0 1px 5px 0 rgba(0, 0, 0, 0.12),
		                  0 3px 1px -2px rgba(0, 0, 0, 0.2);
		};

		.material-shadow[elevation="2"] {
		  box-shadow:0 4px 5px 0 rgba(0, 0, 0, 0.14),
		                  0 1px 10px 0 rgba(0, 0, 0, 0.12),
		                  0 2px 4px -1px rgba(0, 0, 0, 0.4);
		};

		.material-shadow[elevation="3"] {
		  box-shadow:0 6px 10px 0 rgba(0, 0, 0, 0.14),
		                  0 1px 18px 0 rgba(0, 0, 0, 0.12),
		                  0 3px 5px -1px rgba(0, 0, 0, 0.4);
		};

		.material-shadow[elevation="4"] {
		  box-shadow:0 8px 10px 1px rgba(0, 0, 0, 0.14),
		                  0 3px 14px 2px rgba(0, 0, 0, 0.12),
		                  0 5px 5px -3px rgba(0, 0, 0, 0.4);
		};

		.material-shadow[elevation="5"] {
		  box-shadow:0 16px 24px 2px rgba(0, 0, 0, 0.14),
		                  0  6px 30px 5px rgba(0, 0, 0, 0.12),
		                  0  8px 10px -5px rgba(0, 0, 0, 0.4);
		};


	</style>
	<template>
		<div id="page-container">
			<div id="page-cover" class="material-shadow" elevation="3">
				<div id="page-cover-header">
					<div id="page-cover-header-container">
						<paper-fab icon="arrow-back"></paper-fab><br>
						<h2>{{header}}</h2>
					</div>
				</div>
				<div id="page-cover-background"></div>

			</div>
			<div id="page-item" class="material-shadow" elevation="5">
				<content></content>
			</div>
		</div>

	</template>
</dom-module>
<script>
	Polymer({
		is: 'page-item',
		behaviors: [ ],
		listeners: {
			"click": "_clickListener"
		},
		page_stack: [],


		created: function() {

		},

		ready: function() {
			//
			(this.localName + '#' + this.id + ' is ready');
			// DOM OBJECTS
			this.page_container = this.$['page-container'];
			this.page_item = this.$['page-item'];
			this.page_cover = this.$['page-cover'];
			this.default_width = 0;

			var self = this;
			//this.page_item.style.marginLeft = "100%";
			//this.page_item.style.opacity = "0";

  		},

		attached: function() {
			var self = this;

			this.page_item.style.marginLeft = "100%";

			this.page_cover.addEventListener("click",function(e){
				self._onCoverClick();
			},false);

			this.fire("page:ready", {caller:self});
		},

		_onCoverClick: function(e) {
			this.fire("page:out", {caller:this, index:this.index});
		},

		_removeSelf: function(e) {
			this.fire("page:remove", {caller:this, index:this.index});
			// DESTROY
		},

		_onLoad: function(e) {
		},

		/* Using IronA11yKeysBehavior, listen for 'esc' key pressed
		 * anywhere on the page (see keyEventTarget property).
		 * escape will hide a zoomed image.
		 */
		_handleEscapeKey: function(e) {

		},

		/* 	Click Listener
			Support users clicking on the small image to get the big one,
			and the big one to hide it and go back to the small one.
		================================================== */
		_clickListener: function(e) {
			//this.zoomed = (e.target.id == 'thumbnail');
			//this.pageOff(e);

		},

		/* WHEN TRANSITION ENDS
		================================================== */
		_onBackgroundTransition: function(e) {
			// this.background.style.display = "none";
			// this.zoom_container.classList.remove('container-zoomed');

		},

		/* PAGE BEHAVIORS
		================================================== */

		// Removes page
		pageOut: function() {
			// TRANSITION LISTENERS
			//this.page_item.setAttribute("class", "loaded");
			var self = this;
			this.page_item.addEventListener("transitionend",function(e){
				self._removeSelf();
			},false);

			this.page_item.addEventListener("webkitTransitionEnd",function(e){
				self._removeSelf();
			},false);

			this.page_item.style.marginLeft = "100%";



		},

		// Page is no longer active but is visible in the page_stack
		pageOff: function(stack_depth_position, stack_depth, index, stack_width) {

			var left_pos = 100 - stack_depth_position,
				self = this;

			this.index = index;


			this.page_cover.style.marginLeft = "0%";
			this.page_cover.style.height = "100vh";
			this.page_cover.style.width = "75%";

			this.page_cover.style.display = "block";
			this.page_cover.style.zIndex = stack_depth + 1;
			//this.page_cover.style.marginLeft = -left_pos + 25 + "%";
			this.page_cover.style.right = left_pos + "%";
			this.page_cover.style.width = stack_width + "%";

			this.page_cover.style.zIndex = 2;
			this.page_item.style.zIndex = 1;
			this.page_container.style.zIndex = stack_depth;

			this.page_item.style.width = "75%";
			this.page_item.style.marginLeft = -left_pos + 25 + "%";
			this.page_item.style.opacity = "1";
			this.page_item.setAttribute("elevation", "1");


			setTimeout(function(){
				// self.page_cover.style.marginLeft = -left_pos + 25 + "%";
				// self.page_item.style.marginLeft = -left_pos + 25 + "%";
				//self.page_item.style.zIndex = stack_depth;
			}, 250);

			setTimeout(function(){
				self.page_cover.style.opacity = "1";
			}, 750);
			//this.page_item.style.width = "100%";

		},

		// Page is at the top of the page_stack
		_pageOn: function(single) {

			if (single) {
				this.page_item.style.marginLeft = "0%";
				this.page_item.style.width = "100%";
			} else {
				this.page_item.style.marginLeft = "25%";
				this.page_item.style.width = "75%";
			}

			this.page_item.style.opacity = "1";


			this.page_cover.style.opacity = "0";
			this.page_cover.style.height = "0px";

			var self = this;
			setTimeout(function(){
				self.page_container.style.zIndex = 10;

				self.page_item.setAttribute("elevation", "5");
			}, 500);

		},

		pageOn: function(single) {
			var self = this;
			setTimeout(function(){
				self._pageOn(single);
			}, 100);
		},

		getContainerRect: function() {
		  return this.page_item.getBoundingClientRect();		
		},
		/* PROPERTIES
		================================================== */
		properties: {
			header: {
				type: String,
				value: "Header"
			}
		}

	});
</script>
